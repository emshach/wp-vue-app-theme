{"version":3,"sources":["webpack:///./js/components/program/index.js","webpack:///./js/components/program/template.html","webpack:///./js/lib/scroll-header.js"],"names":["template","require","props","data","sstate","store","state","storedPost","promos","show","mounted","Object","assign","nextpost","document","title","he","decode","site","window","setTimeout","promo_reel","$nextTick","ScrollHeader","init","methods","showImg","computed","postData","post","rendered","img","background_image","episodes","releases","episodesTitle","title_releases","archives","archivesTitle","title_archives","content","user","member_content","as","subscriber","membership","classes","small","length","watch","$route","to","from","last_scroll","scroll_dir","$","header","container","_","$el","scrollTop","off","on","e","last","dir","cur","$head","stop","animate","top","innerHeight","topH","removeClass","addClass","destroy","jQuery"],"mappings":"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","file":"12.js","sourcesContent":["import store from '../../lib/store';\nimport ScrollHeader from '../../lib/scroll-header';\nimport he from 'he';\nexport default {\n  template: require( './template.html' ),\n  props: [ 'post' ],\n  data() {\n    return {\n      sstate: store.state,\n      storedPost: {},\n      promos: [],\n      show: false\n    };\n  },\n  mounted() {\n    this.storedPost = Object.assign( {}, this.sstate.nextpost );\n    document.title = he.decode( this.title + ' | ' + this.sstate.site.title );\n    window.setTimeout(() => {\n      this.promos = this.promo_reel;\n    }, 1500 );\n    this.$nextTick(() => {\n      ScrollHeader.init( '#masthead', \"#featured,#app>.page>.featured-outer\" );\n    });\n  },\n  methods: {\n    showImg() {\n      this.show = true;\n    }\n  },\n  computed: {\n    postData() {\n      return this.post || this.storedPost;\n    },\n    title() {\n      return this.postData.title && this.postData.title.rendered || '';\n    },\n    img() {\n      return this.postData.background_image || '';\n    },\n    promo_reel() {\n      return this.postData.promo_reel || [];\n    },\n    episodes() {\n      return this.postData.releases || [];\n    },\n    episodesTitle() {\n      return this.postData.title_releases || 'Programmes';\n    },\n    archives() {\n      return this.postData.archives || [];\n    },\n    archivesTitle() {\n      return this.postData.title_archives || 'From the Archives';\n    },\n    content() {\n      const user = this.sstate.user;\n      if ( this.postData.member_content\n           && ( user.as ? user.as.subscriber : user.membership ))\n        return this.postData.member_content;\n      return this.postData.content && this.postData.content.rendered || '';\n    },\n    classes() {\n      return { small: !this.promos.length };\n    }\n  },\n  watch: {\n    $route( to, from ) {\n      this.promos = [];\n      this.storedPost = Object.assign( {}, this.sstate.nextpost );\n      document.title = he.decode( this.title + ' | ' + this.sstate.site.title );\n      window.setTimeout(() => {\n        this.promos = this.promo_reel;\n      }, 1500 );\n    }\n  }\n};\n","module.exports = \"<div class=\\\"program post page\\\" :key=\\\"postData.id\\\">\\n  <div id=\\\"bg-image-wrapper\\\">\\n    <transition name=\\\"fade-in\\\" appear>\\n      <img id=\\\"bg-image\\\" :src=\\\"img\\\" :key=\\\"img\\\" @load=\\\"showImg\\\" v-show=\\\"show\\\"/>\\n    </transition>\\n  </div>\\n  <down-arrow></down-arrow>\\n  <div class=\\\"featured-outer\\\" :class=\\\"classes\\\">\\n    <transition name=\\\"fade-slow\\\">\\n      <div v-if=\\\"promos.length\\\" class=\\\"featured-wrapper\\\">\\n        <mrk-carousel id=\\\"featured\\\" :slides=\\\"promos\\\"></mrk-carousel>\\n      </div>\\n    </transition>\\n  </div>\\n\\n  <main role=\\\"main\\\">\\n    <h1 class=\\\"title\\\" v-html=\\\"title\\\"></h1>\\n    <section class=\\\"description\\\" v-html=\\\"content\\\"></section>\\n    <content-section v-if=\\\"!postData.hide_programs\\\"\\n                     :title=\\\"episodesTitle\\\"\\n                     :coming=\\\"postData.release_date\\\"\\n                     :hide-coming=\\\"postData.hide_coming\\\"\\n                     :labels=\\\"postData.episode_labels\\\"\\n                     :episodes=\\\"episodes\\\"></content-section>\\n    <content-section :title=\\\"archivesTitle\\\"\\n                     :episodes=\\\"archives\\\"\\n                     :labels=\\\"postData.episode_labels\\\"\\n                     :show-empty=\\\"false\\\"></content-section>\\n    <comments></comments>\\n  </main>\\n  <wp-footer></wp-footer>\\n</div>\\n\";","const ScrollHeader = {\n  last_scroll: 0,\n  scroll_dir: 'none'\n};\n\n(function ($) {\n  ScrollHeader.init = ( header, container ) => {\n    var _ = ScrollHeader;\n    var $el = $( \"#app>.page\" );\n    _.last_scroll = $el.scrollTop();\n    $el.off( 'scroll' );\n    $el.on( 'scroll', e => {\n      var last = _.last_scroll;\n      var dir = _.scroll_dir;\n      var cur = _.last_scroll = $el.scrollTop();\n      var $head = $( header );\n      \n      if ( last < cur ) {\n        if ( dir != (_.scroll_dir = 'down' ))\n          $head.stop().animate( { top: - $head.innerHeight() - 10 }, 'slow' );\n      } else if ( last > cur ) {\n        if ( dir != (_.scroll_dir = 'up' ))\n          $head.stop().animate( { top: 0 }, 'slow' );\n      } else\n        _.scroll_dir = 'none';\n      var topH = $( container ).innerHeight() - $head.innerHeight() + 20;\n      if ( cur > topH ) \n        $head.removeClass( 'mrk-bg-clear' ).addClass( 'mrk-bg-dark' );\n      else\n        $head.removeClass( 'mrk-bg-dark' ).addClass( 'mrk-bg-clear' );\n    });\n  };\n  ScrollHeader.destroy = () => {\n    $( \"#app>.page\" ).off( 'scroll' );\n  };\n})( jQuery );\n\nexport default ScrollHeader;\n"],"sourceRoot":""}
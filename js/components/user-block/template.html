<b-dd id="user">
  <template slot="button-content">
    <span class="dashicons dashicons-admin-users"></span>
    {{ loggedIn ? user.display_name: 'sign in' }}
  </template>
  <transition name="fast-fade" mode="out-in">
    <b-dd-item v-if="loggedIn" :href="logoutLink">log out</b-dd-item>
    <b-form v-else-if="action == 'unknown-user'" @submit="login"
            :class="[ 'login', action ]">
      <b-alert show variant="warning">We're sorry, we don't have that username

        on record. Please check and re-enter the username or use your email
        address. Hit sign-up to create a new account.</b-alert>
      <b-form-group id="login-username"
                    label="email address"
                    label-for="username">
        <b-form-input id="username"
                      type="text"
                      v-model="loginForm.login"
                      required></b-form-input>
      </b-form-group>
      <b-form-group class="login-actions">
        <b-btn v-if="action != 'register'" type="submit" variant="primary"
               name="wp-submit" class="login-button" value="Log in"
               @click="actionLogin">try again</b-btn>
        <span v-if="action != 'register'">or</span>
        <b-btn type="submit" variant="success" name="wp-submit"
               class="register-button" value="Register"
               @click="actionRegister">sign-up</b-btn>
      </b-form-group>
    </b-form>
    <b-form v-else-if="action == 'unknown-email'" @submit="login"
            :class="[ 'login', action ]">
      <b-alert show variant="warning">We're sorry, we have no record of that
      email address. If you entered the email incorrectly you can re-enter it
      below to retry. or hit sign-up to create an account</b-alert>
      <b-form-group id="login-email"
                    label="email address"
                    label-for="email">
        <b-form-input id="email"
                      type="email"
                      v-model="loginForm.email"
                      required></b-form-input>
      </b-form-group>
      <b-form-group class="login-actions">
        <b-btn v-if="action != 'register'" type="submit" variant="primary"
               name="wp-submit" class="login-button" value="Log in"
               @click="actionLogin">try again</b-btn>
        <span v-if="action != 'register'">or</span>
        <b-btn type="submit" variant="success" name="wp-submit"
               class="register-button" value="Register"
               @click="actionRegister">sign-up</b-btn>
      </b-form-group>
    </b-form>
    <b-form v-else @submit="login"
            :class="[ 'login', action ]">
      <b-form-group id="login-username"
                    :label="action == 'register' ? 'username'
                            : 'username or email address'"
                    label-for="username">
        <b-form-input id="username"
                      type="text"
                      v-model="loginForm.login"
                      required></b-form-input>
      </b-form-group>
      <transition name="fade-fast">
        <b-form-group v-if="action == 'register'"
                      id="login-email"
                      label="email address"
                      label-for="email">
          <b-form-input id="email"
                        type="email"
                        v-model="loginForm.email"
                        required></b-form-input>
        </b-form-group>
      </transition>
      <transition name="fade-fast" mode="out-in">
        <div id="login-password" v-if="tokenLogin">
          <b-alert v-if="action == register" show>A password will be generated
          for you and sent with your confirmation email.</b-alert>
          <b-alert v-else show>An email will be sent with a link that will log
            you in when you click it. This link will expire in 10
            minutes.</b-alert>
          <b-btn variant="link" @click="enterPass">set password now</b-btn>
        </div>
        <b-form-group v-else-if="action == 'register'"
                      id="login-password">
          <b-form-group id="login-password1"
                        label="password"
                        label-for="password1">
            <b-form-input id="password1"
                          type="password"
                          v-model="loginForm.pass"
                          required></b-form-input>
          </b-form-group>
          <b-form-group id="login-password1"
                        label="confirm password"
                        label-for="password2">
            <b-form-input id="password2"
                          type="password"
                          v-model="confirmPass"
                          required></b-form-input>
          </b-form-group>
          <b-btn variant="link" @click="sendLink">don't set password now</b-btn>
        </b-form-group>
        <b-form-group v-else
                      id="login-password"
                      label="password"
                      label-for="password">
          <b-form-input id="password"
                        type="password"
                        v-model="loginForm.pass"
                        required></b-form-input>
          <b-btn variant="link" @click="sendLink">email login link instead</b-btn>
        </b-form-group>
      </transition>
      <b-form-group>
        <vue-recaptcha :sitekey="recaptcha.key"
                       @verify="recaptchaSuccess"
                       theme="dark"></vue-recaptcha>
      </b-form-group>
      <b-form-group class="login-actions">
        <b-btn v-if="action != 'register'" type="submit" variant="primary"
               name="wp-submit" class="login-button" value="Log in"
               @click="actionLogin">login</b-btn>
        <b-btn v-else variant="link" @click="clearForm"
               class="login-button">cancel</b-btn>
        <span v-if="action != 'register'">or</span>
        <b-btn type="submit" variant="success" name="wp-submit"
               class="register-button" value="Register"
               @click="actionRegister">sign-up</b-btn>
      </b-form-group>
    </b-form>
  </transition>
</b-dd>

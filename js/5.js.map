{"version":3,"sources":["webpack:///./js/components/home/index.js","webpack:///./js/components/home/template.html","webpack:///./js/lib/scroll-header.js"],"names":["template","require","data","sstate","store","state","promos","latest","trending","recent","history","discovery","favs","img","title","show","mounted","document","he","decode","site","_wpapix","then","wpapix","path","Path","fetch","done","rpost","console","log","rendered","background_image","window","setTimeout","promo_reel","$nextTick","ScrollHeader","init","methods","showImg","computed","user","isSubscriber","as","subscriber","membership","last_scroll","scroll_dir","$","header","top","_","$el","scrollTop","off","scroll","e","last","cur","$head","stop","animate","innerHeight","topH","removeClass","addClass","destroy","jQuery"],"mappings":"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","file":"5.js","sourcesContent":["import store from '../../lib/store';\nimport _wpapix from '../../lib/wpapix';\nimport ScrollHeader from '../../lib/scroll-header';\nimport he from 'he';\nexport default {\n  template: require( './template.html' ),\n  data () {\n    return {\n      sstate: store.state,\n      promos: [],\n      latest: [],\n      trending: [],\n      recent: [],\n      history: [],\n      discovery: [],\n      favs: [],\n      img: '',\n      title: '',\n      show: false\n    };\n  },\n  mounted() {\n    document.title = he.decode( this.sstate.site.title );\n    _wpapix.then( wpapix => {\n      var path = new wpapix.Path();\n      path.fetch().done(( rpost ) => {\n        console.log( 'got home page', rpost );\n        this.title = rpost.title.rendered;\n        this.img = rpost.background_image || '';\n        window.setTimeout(() => {\n          this.promos = rpost.promo_reel || [];\n        }, 4000 );\n      });\n    });\n    this.$nextTick(() => {\n      ScrollHeader.init( '#masthead', \"#featured,#app>.page>.featured-outer\" );\n    });\n  },\n  methods: {\n    showImg() {\n      this.show = true;\n    }\n  },\n  computed: {\n    user() {\n      return this.sstate.user;\n    },\n    isSubscriber() {\n      return this.user && (!this.user.as || this.user.as.subscriber )\n         && this.user.membership;\n    }\n  }\n};\n","module.exports = \"<div class=\\\"home page\\\">\\n  <div id=\\\"bg-image-wrapper\\\">\\n    <transition name=\\\"fade-in\\\">\\n      <img id=\\\"bg-image\\\" :src=\\\"img\\\" @load=\\\"showImg\\\" v-show=\\\"show\\\"/>\\n    </transition>\\n  </div>\\n  <down-arrow></down-arrow>\\n  <div class=\\\"featured-outer\\\">\\n    <transition name=\\\"fade-slow\\\" appear>\\n      <div v-if=\\\"promos.length\\\" class=\\\"featured-wrapper\\\" key=\\\"featured\\\">\\n        <mrk-carousel id=\\\"featured\\\"\\n                      :slides=\\\"promos\\\"></mrk-carousel>\\n      </div>\\n    </transition>\\n  </div>\\n\\n  <main role=\\\"main\\\">\\n    <h1 class=\\\"title\\\">{{ title }}</h1>\\n    <content-list title=\\\"latest\\\" :contents=\\\"latest\\\"></content-list>\\n    <filmstrip title=\\\"trending\\\" :contents=\\\"trending\\\"></filmstrip>\\n    <filmstrip title=\\\"recent activity\\\" :contents=\\\"recent\\\"></filmstrip>\\n    <filmstrip title=\\\"pull up\\\" :contents=\\\"history\\\"></filmstrip>\\n    <filmstrip title=\\\"you might like\\\" :contents=\\\"discovery\\\"></filmstrip>\\n    <filmstrip title=\\\"my faves\\\" :contents=\\\"favs\\\"></filmstrip>\\n  </main>\\n  <wp-footer></wp-footer>\\n</div>\\n\";","const ScrollHeader = {\n  last_scroll: 0,\n  scroll_dir: 'none'\n};\n\n(function ($) {\n  ScrollHeader.init = ( header, top ) => {\n    var _ = ScrollHeader;\n    var $el = $( \"#app>.page\" );\n    _.last_scroll = $el.scrollTop();\n    $el.off( 'scroll' ).scroll( e => {\n      var last = _.last_scroll;\n      var cur = _.last_scroll = $el.scrollTop();\n      var $head = $( header );\n      \n      if ( last < cur ) {\n        _.scroll_dir = 'down';\n        $head.stop().animate( { top: 0 });\n      } else if ( last > cur ) {\n        _.scroll_dir = 'up';\n        $head.stop().animate( { top: - $head.innerHeight() - 10 });\n      } else\n        _.scroll_dir = 'none';\n      var topH = $( top ).innerHeight() - $head.innerHeight() + 20;\n      if ( cur > topH ) \n        $head.removeClass( 'bg-clear' ).addClass( 'bg-dark' );\n      else\n        $head.removeClass( 'bg-dark' ).addClass( 'bg-clear' );\n    });\n  };\n  ScrollHeader.destroy = () => {\n    $( \"#app>.page\" ).off( 'scroll' );\n  };\n})( jQuery );\n\nexport default ScrollHeader;\n"],"sourceRoot":""}